<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EXE URL Analyzer - Download & Analyze</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-functions-compat.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸŒ EXE URL Analyzer</h1>
            <p class="subtitle">Inserisci URL di un file .exe per analizzarlo - <strong>Solo file legittimi e sicuri</strong></p>
        </header>

        <div class="disclaimer warning">
            <strong>âš ï¸ SICUREZZA MASSIMA:</strong> Analizzeremo solo file da fonti verificate. Non inserire URL sospetti o a scopo malevolo.
        </div>

        <div class="url-input-section">
            <div class="input-group">
                <input 
                    type="url" 
                    id="urlInput" 
                    placeholder="https://example.com/file.exe o https://github.com/user/repo/releases/download/v1.0/app.exe"
                    autocomplete="off"
                >
                <button class="btn" id="analyzeUrlBtn">ğŸ” Analizza da URL</button>
            </div>
            
            <div class="url-examples">
                <p>Esempi consentiti:</p>
                <ul>
                    <li>GitHub Releases (https://github.com/...) âœ…</li>
                    <li>Dropbox direct links âœ…</li>
                    <li>Google Drive direct links âœ…</li>
                    <li>Domini whitelistati âœ…</li>
                    <li>Altri .exe pubblici âš ï¸ (analisi limitata)</li>
                </ul>
            </div>
        </div>

        <div class="results" id="results" style="display: none;">
            <h2>ğŸ“Š Risultati Analisi</h2>
            
            <div class="file-info card">
                <h3>ğŸ“ Informazioni File</h3>
                <div id="fileInfo"></div>
            </div>
            
            <div class="analysis-grid">
                <div class="card">
                    <h3>ğŸ”’ Sicurezza</h3>
                    <div id="securityResults"></div>
                </div>
                <div class="card">
                    <h3>ğŸ—ï¸ Struttura</h3>
                    <div id="structureResults"></div>
                </div>
                <div class="card">
                    <h3>ğŸ“ Metadati</h3>
                    <div id="metadataResults"></div>
                </div>
                <div class="card">
                    <h3>âš ï¸ Rischio</h3>
                    <div id="riskResults"></div>
                </div>
            </div>
            
            <div class="hex-preview card">
                <h3>ğŸ”¢ Hex Preview (primi 512 bytes)</h3>
                <pre id="hexPreview"></pre>
            </div>
            
            <div class="action-buttons">
                <button class="btn secondary" id="downloadExeBtn">â¬‡ï¸ Scarica .exe</button>
                <button class="btn" id="newAnalysisBtn">ğŸ”„ Nuova Analisi</button>
            </div>
        </div>

        <div class="loading" id="loading" style="display: none;">
            <div class="spinner"></div>
            <p>Scaricamento e analisi in corso...</p>
            <p class="small" id="statusText">Connessione al server...</p>
        </div>

        <footer>
            <p>Tool educativo per analisi sicurezza - Non usare per scopi malevoli</p>
            <p class="small">Tutti i download passano attraverso proxy Firebase per sicurezza</p>
        </footer>
    </div>

    <script src="js/firebase-config.js"></script>
    <script src="js/downloader.js"></script>
    <script src="js/analyzer.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
